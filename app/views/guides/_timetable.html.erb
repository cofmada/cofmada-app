<% if videos.any? %>

  <%= form_with(model: guide, method: :delete) do |f| %>  
    <div class="row blue-w mx-0 p-0">
      
      <% if current_page?(edit_guide_path) %>
        <div class="text-center mini border-bottom m-0 py-2 px-0">※動画をチェックし【削除】で一括削除できます</div>
      <% end %>
      
      <table class="row scroll p-1 m-0">
        <tbody>
          <% h = 5 %>
          <% while h < 29 %>
      
            <% if h < 24 %>
              <tr class="border_top">
                <th class="text-center px-1 m-0" rowspan="2" id="hour<%= h %>"><%= h %></th>
                <td class="small border_right px-1 m-0" id="just_m<%= h %>">:00</td>
                
                <% if @start.include?(h) %>
                  <% just = @guide_videos.where(start_h: h, start_m: 0).pluck(:video_id) %>
                  <% just_v = @videos.where(id: just).distinct %>
                  <% just_v.each do |v| %>
                  
                    <td class="wide m-0 px-0 just_m<%= h %>">
                      <% if v.thumbnail.present? %>
                        <figure class="hover-parent m-0 p-0">
                          <a href="<%= v.video_url %>">
                            <img src="<%= v.thumbnail %>" alt="" class="px-1 m-0">
                            <figcaption class="hover-mask m-0 px-2"><%= v.video_name %></figcaption></a>
                        </figure>
                      <% else %>
                        <div class="thumb_alt text-center m-0 p-0">
                          <%= image_tag "/assets/"+v.media+".png", alt: "", class: "thumb" %>
                          <div class="thumb_cap text-center"><%= v.media %></div>
                        </div>
                      <% end %>
                      
                      <% ch = @channels.find_by(id: v.channel_id) %>
                      <% if ch.icon.present? %>
                        <img src="<%= ch.icon %>" alt="" class="icon">
                        <% if current_page?(edit_guide_path) %>
                          <%= f.check_box :video_id, { multiple: true, style: 'transform: scale(2);', id: v.id }, v.id, false %>
                        <% end %>
                      <% else %>
                        <div class="icon py-1 px-3">
                          <% if current_page?(edit_guide_path) %>
                            <%= f.check_box :video_id, { multiple: true, style: 'transform: scale(2);', id: v.id }, v.id, false %>
                          <% end %>
                        </div>
                      <% end %>
                      
                      <div class="omit wide text-start">
                        <a href="<%= ch.channel_url %>"><span><%= ch.channel_name %></span></a>
                      </div>
                    </td>
                  <% end %>
                <% end %>
              </tr>
              
              <tr class="border_bottom">
                <td class="small border_right px-1 m-0 half_m<%= h %>">:30</td>
                
                <% if @start.include?(h) %>
                  <% half = @guide_videos.where(start_h: h, start_m: 30).pluck(:video_id) %>
                  <% half_v = @videos.where(id: half).distinct %>
                  <% half_v.each do |v| %>
                  
                    <td class="wide m-0 px-0" id="half_m<%= h %>">
                      <% if v.thumbnail.present? %>
                        <figure class="hover-parent m-0 p-0">
                          <a href="<%= v.video_url %>">
                            <img src="<%= v.thumbnail %>" alt="" class="px-1 m-0">
                            <figcaption class="hover-mask m-0 px-2"><%= v.video_name %></figcaption></a>
                        </figure>
                      <% else %>
                        <div class="thumb_alt text-center m-0 p-0">
                          <%= image_tag "/assets/"+v.media+".png", alt: "", class: "thumb" %>
                          <div class="thumb_cap text-center"><%= v.media %></div>
                        </div>
                      <% end %>
                      
                      <% ch = @channels.find_by(id: v.channel_id) %>
                      <% if ch.icon.present? %>
                        <img src="<%= ch.icon %>" alt="" class="icon">
                        <% if current_page?(edit_guide_path) %>
                          <%= f.check_box :video_id, { multiple: true, style: 'transform: scale(2);', id: v.id }, v.id, false %>
                        <% end %>
                      <% else %>
                        <div class="icon py-1 px-3">
                          <% if current_page?(edit_guide_path) %>
                            <%= f.check_box :video_id, { multiple: true, style: 'transform: scale(2);', id: v.id }, v.id, false %>
                          <% end %>
                        </div>
                      <% end %>
                      
                      <div class="omit wide">
                        <a href="<%= ch.channel_url %>"><span><%= ch.channel_name %></span></a>
                      </div>
                    </td>
                  <% end %>
                <% end %>
              </tr>
      
            <% else h > 23 %>
              <% mh = h - 24 %>
              <tr class="border_top">
                <th class="text-center px-1 m-0" rowspan="2" id="hour<%= mh %>"><%= mh %></th>
                <td class="small border_right px-1 m-0" id="just_m<%= mh %>">:00</td>
                
                <% if @start.include?(mh) %>
                  <% just = @guide_videos.where(start_h: mh, start_m: 0).pluck(:video_id) %>
                  <% just_v = @videos.where(id: just).distinct %>
                  <% just_v.each do |v| %>
                  
                    <td class="wide m-0 px-0 just_m<%= mh %>">
                      <% if v.thumbnail.present? %>
                        <figure class="hover-parent m-0 p-0">
                          <a href="<%= v.video_url %>">
                            <img src="<%= v.thumbnail %>" alt="" class="px-1 m-0">
                            <figcaption class="hover-mask m-0 px-2"><%= v.video_name %></figcaption></a>
                        </figure>
                      <% else %>
                        <div class="thumb_alt text-center mx-1 px-0">
                          <%= image_tag "/assets/"+v.media+".png", alt: "", class: "thumb" %>
                          <div class="thumb_cap text-center"><%= v.media %></div>
                        </div>
                      <% end %>
                      
                      <% ch = @channels.find_by(id: v.channel_id) %>
                      <% if ch.icon.present? %>
                        <img src="<%= ch.icon %>" alt="" class="icon">
                        <% if current_page?(edit_guide_path) %>
                          <%= f.check_box :video_id, { multiple: true, style: 'transform: scale(2);', id: v.id }, v.id, false %>
                        <% end %>
                      <% else %>
                        <div class="icon py-1 px-3">
                          <% if current_page?(edit_guide_path) %>
                            <%= f.check_box :video_id, { multiple: true, style: 'transform: scale(2);', id: v.id }, v.id, false %>
                          <% end %>
                        </div>
                      <% end %>
                      
                      <div class="omit wide">
                        <a href="<%= ch.channel_url %>"><span><%= ch.channel_name %></span></a>
                      </div>
                    </td>
                  <% end %>
                <% end %>
              </tr>
              
              <tr class="border_bottom">
                <td class="small border_right px-1 m-0 half_m<%= mh %>">:30</td>
                
                <% if @start.include?(mh) %>
                  <% half = @guide_videos.where(start_h: mh, start_m: 30).pluck(:video_id) %>
                  <% half_v = @videos.where(id: half).distinct %>
                  <% half_v.each do |v| %>
                  
                    <td class="wide m-0 px-0" id="half_m<%= mh %>">
                      <% if v.thumbnail.present? %>
                        <figure class="hover-parent m-0 p-0">
                          <a href="<%= v.video_url %>">
                            <img src="<%= v.thumbnail %>" alt="" class="px-1 m-0">
                            <figcaption class="hover-mask m-0 px-2"><%= v.video_name %></figcaption></a>
                        </figure>
                      <% else %>
                        <div class="thumb_alt text-center mx-1 px-0">
                          <%= image_tag "/assets/"+v.media+".png", alt: "", class: "thumb" %>
                          <div class="thumb_cap text-center"><%= v.media %></div>
                        </div>
                      <% end %>
                      
                      <% ch = @channels.find_by(id: v.channel_id) %>
                      <% if ch.icon.present? %>
                        <img src="<%= ch.icon %>" alt="" class="icon">
                        <% if current_page?(edit_guide_path) %>
                          <%= f.check_box :video_id, { multiple: true, style: 'transform: scale(2);', id: v.id }, v.id, false %>
                        <% end %>
                      <% else %>
                        <div class="icon py-1 px-3">
                          <% if current_page?(edit_guide_path) %>
                            <%= f.check_box :video_id, { multiple: true, style: 'transform: scale(2);', id: v.id }, v.id, false %>
                          <% end %>
                        </div>
                      <% end %>
                      
                      <div class="omit wide">
                        <a href="<%= ch.channel_url %>"><span><%= ch.channel_name %></span></a>
                      </div>
                    </td>
                  <% end %>
                <% end %>
              </tr>
            <% end %>
            
            <% h += 1 %>
            
          <% end %>  
        </tbody>
      </table>
    </div>
    
    <div class="blue-w text-center align-items-center m-0 px-0 py-2" id="hidden">
      <%= f.submit '削除', data: { confirm: '動画を削除しますか？' }, class: 'd-metal btn py-0 px-3' %>
    </div>
    <div class="blue-w text-center align-items-center m-0 px-0 py-2" id="show">
      <%= link_to '編集へ', edit_guide_path(params[:id]), class: 'd-metal btn py-0 px-2' %>
    </div>
    
  <% end %>
  
<% else %>
  <div class="blue-w text-center m-0 p-2">動画が登録されていません...</div>
<% end %>
